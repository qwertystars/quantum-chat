version: '3.8'

services:
  backend:
    build:
      context: ./backend
      dockerfile: Dockerfile
    container_name: quantum-chat-backend
    ports:
      - "8000:8000"
    environment:
      - PYTHONUNBUFFERED=1
      - PYTHONDONTWRITEBYTECODE=1
    # Read-only filesystem
    read_only: true
    # Tmpfs mounts for directories that need write access
    tmpfs:
      - /tmp:size=100M,mode=1777
      - /run:size=10M,mode=755

  frontend:
    build:
      context: ./frontend
      dockerfile: Dockerfile
    container_name: quantum-chat-frontend
    ports:
      - "3000:3000"
    # Read-only filesystem
    read_only: true
    # Tmpfs mounts for directories that need write access
    tmpfs:
      - /tmp:size=100M,mode=1777
      - /app/.vite:size=50M,mode=755
    depends_on:
      - backend

networks:
  default:
    name: quantum-chat-network
